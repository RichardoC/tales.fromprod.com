<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Managing Google Groups via the API, aka what they don't want you to do! - Tales from Prod</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Managing Google Groups via the API, aka what they don’t want you to do! | Tales from Prod</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Managing Google Groups via the API, aka what they don’t want you to do!" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Managing Google Groups via the API, despite their best efforts Google have made it difficult to do this, they somewhat document two different APIs to achieve this, with limited success. This is especially true if you want to use a service account rather than a user API token for the management." /> <meta property="og:description" content="Managing Google Groups via the API, despite their best efforts Google have made it difficult to do this, they somewhat document two different APIs to achieve this, with limited success. This is especially true if you want to use a service account rather than a user API token for the management." /> <link rel="canonical" href="https://tales.fromprod.com/2021/222/managing-google-groups-via-api.html" /> <meta property="og:url" content="https://tales.fromprod.com/2021/222/managing-google-groups-via-api.html" /> <meta property="og:site_name" content="Tales from Prod" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-08-10T03:00:00+01:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Managing Google Groups via the API, aka what they don’t want you to do!" /> <script type="application/ld+json"> {"description":"Managing Google Groups via the API, despite their best efforts Google have made it difficult to do this, they somewhat document two different APIs to achieve this, with limited success. This is especially true if you want to use a service account rather than a user API token for the management.","headline":"Managing Google Groups via the API, aka what they don’t want you to do!","dateModified":"2021-08-10T03:00:00+01:00","@type":"BlogPosting","datePublished":"2021-08-10T03:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tales.fromprod.com/2021/222/managing-google-groups-via-api.html"},"url":"https://tales.fromprod.com/2021/222/managing-google-groups-via-api.html","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://tales.fromprod.com/" class="site-title lh-tight"> Tales from Prod </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://tales.fromprod.com/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://tales.fromprod.com/" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="https://tales.fromprod.com/categories/" class="nav-list-link">Categories</a></li><li class="nav-list-item"><a href="https://tales.fromprod.com/useful-resources.html" class="nav-list-link">Useful resources</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Tales from Prod" aria-label="Search Tales from Prod" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="managing-google-groups-via-the-api-despite-their-best-efforts"> <a href="#managing-google-groups-via-the-api-despite-their-best-efforts" class="anchor-heading" aria-labelledby="managing-google-groups-via-the-api-despite-their-best-efforts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Managing Google Groups via the API, despite their best efforts </h1> <p>Google have made it difficult to do this, they somewhat document two different APIs to achieve this, with limited success. This is especially true if you want to use a service account rather than a user API token for the management.</p> <ul> <li><a href="https://developers.google.com/admin-sdk/directory/v1/guides/manage-groups">Using the directory API</a></li> <li><a href="https://cloud.google.com/identity/docs/how-to/create-dynamic-groups">Using the Cloud Identity APIs - newer and seems to be preferred going forward</a></li> </ul> <p>At the time of writing, this are not sufficiently detailed to do more than work out those are the APIs to use. That’s where this guide comes in.</p> <h2 id="what-youll-achieve-by-the-end-of-this-and-why-you-carerephrase"> <a href="#what-youll-achieve-by-the-end-of-this-and-why-you-carerephrase" class="anchor-heading" aria-labelledby="what-youll-achieve-by-the-end-of-this-and-why-you-carerephrase"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What you’ll achieve by the end of this and why you care//rephrase </h2> <p>A google group who’s membership is managed (via email address) by a Golang binary. The steps will apply to the other language client libraries</p> <h2 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h2> <ul> <li>Google Cloud Identity Premium</li> <li>A paid for Google Workspace</li> <li>A Google cloud Service Account (SA) <ul> <li>An API key for that SA</li> <li>To record the email address of that SA</li> <li>This SA requires <strong>no permissions at all</strong> in the cloud console</li> </ul> </li> <li>The magic “Customer ID” <ul> <li>This can only be obtained through the steps on [https://support.google.com/a/answer/10070793?hl=en] by a workspace admin</li> </ul> </li> <li>The google group you wish to manage <ul> <li>You should add the SA’s email address as an “OWNER” of that group, and change the subscription to “no emails” as it can’t receive them.</li> </ul> </li> </ul> <h2 id="managing-google-group-membership-in-golang"> <a href="#managing-google-group-membership-in-golang" class="anchor-heading" aria-labelledby="managing-google-group-membership-in-golang"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Managing Google Group membership in Golang </h2> <p>These steps should be equivalent for other languages, but haven’t tried.</p> <h3 id="dependencies"> <a href="#dependencies" class="anchor-heading" aria-labelledby="dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dependencies </h3> <ul> <li>A source of email addresses to add to your group</li> <li>The (cloud identity client library)[https://pkg.go.dev/google.golang.org/api@v0.51.0/cloudidentity/v1]</li> <li>The (Google API options library)[https://pkg.go.dev/google.golang.org/api@v0.52.0/option]</li> </ul> <p>The following is pseudo code and won’t compile without changes</p> <div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">//TODO Add the code that's currently in main.go</span>

</code></pre></div></div> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2021 Richard Finlay Tweed. All rights reserved. All views expressed are my own</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
