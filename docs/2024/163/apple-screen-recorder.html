<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Recording what you see on macOS - no external dependencies | Tales from Prod</title> <meta name="generator" content="Jekyll v3.9.5" /> <meta property="og:title" content="Recording what you see on macOS - no external dependencies" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Recording what you see on macOS - no external dependencies" /> <meta property="og:description" content="Recording what you see on macOS - no external dependencies" /> <link rel="canonical" href="https://tales.fromprod.com/2024/163/apple-screen-recorder.html" /> <meta property="og:url" content="https://tales.fromprod.com/2024/163/apple-screen-recorder.html" /> <meta property="og:site_name" content="Tales from Prod" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-06-11T19:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Recording what you see on macOS - no external dependencies" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-11T19:00:00+00:00","datePublished":"2024-06-11T19:00:00+00:00","description":"Recording what you see on macOS - no external dependencies","headline":"Recording what you see on macOS - no external dependencies","mainEntityOfPage":{"@type":"WebPage","@id":"https://tales.fromprod.com/2024/163/apple-screen-recorder.html"},"url":"https://tales.fromprod.com/2024/163/apple-screen-recorder.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Tales from Prod </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="/categories/" class="nav-list-link">Categories</a></li><li class="nav-list-item"><a href="/useful-resources.html" class="nav-list-link">Useful resources</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Tales from Prod" aria-label="Search Tales from Prod" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="recording-what-you-see-on-macos---no-external-dependencies"> <a href="#recording-what-you-see-on-macos---no-external-dependencies" class="anchor-heading" aria-labelledby="recording-what-you-see-on-macos---no-external-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Recording what you see on macOS - no external dependencies </h1> <p>Without installing <strong>anything</strong> you can automatically record all text shown on screen on macOS and do whatever you want on it.</p> <p>This is published for informational purposes, and to illustrate how difficult “data loss prevention” is, when the very OS you’re using is working against you.</p> <p>I wish I’d published this before the whole <a href="https://support.microsoft.com/en-gb/windows/retrace-your-steps-with-recall-aa03f8a0-a78b-4b3e-b0a1-2eb8ac48701c">Windows Recall thing</a> but hindsight is 20/20.</p> <h2 id="applescript"> <a href="#applescript" class="anchor-heading" aria-labelledby="applescript"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AppleScript </h2> <p>Built in to macOS is <code class="language-plaintext highlighter-rouge">script editor</code> and <code class="language-plaintext highlighter-rouge">automator</code> which can use a proprietary scripting language called <code class="language-plaintext highlighter-rouge">AppleScript</code> which can be used to do everything a mac or iOS app can do, with a few extra niceties. In my opinion it’s very ugly and hard to use as it tries to act like natural prose rather than be an actual compute language. One example is using <code class="language-plaintext highlighter-rouge">class's method</code> rather than class.method.</p> <p>The <a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">documentation</a> is very out of date, though it still works so you’ll have to find information on <a href="https://www.macscripter.net">forums.</a></p> <h2 id="so-what"> <a href="#so-what" class="anchor-heading" aria-labelledby="so-what"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> So what? </h2> <ul> <li>Open spotlight</li> <li>Open “script editor”</li> <li>Paste the code below in the window and save it</li> <li>Click “Run this script” button which looks like a play button</li> <li>See that all text on your screen is now in the script output window.</li> </ul> <p>Congratulations, without installing <em>anything</em> you’ve managed to make something which can recover all text that shows on your macOS display.</p> <p>Apple don’t give you a way to disable AppleScript so I’m not aware of a way to prevent this functionality.</p> <h3 id="sample-code"> <a href="#sample-code" class="anchor-heading" aria-labelledby="sample-code"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sample code </h3> <p>Please only use this for innocent fun, where you have permission.</p> <p>This snippet is provided under an <a href="https://github.com/git/git-scm.com/blob/main/MIT-LICENSE.txt">MIT license</a> and I hold no responsibility for how you choose to use it.</p> <div class="language-applescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="nv">use</span><span class="w"> </span><span class="nv">framework</span><span class="w"> </span><span class="s2">"AppKit"</span><span class="w">
</span><span class="nv">use</span><span class="w"> </span><span class="nv">framework</span><span class="w"> </span><span class="s2">"Foundation"</span><span class="w">
</span><span class="nv">use</span><span class="w"> </span><span class="nv">framework</span><span class="w"> </span><span class="s2">"Vision"</span><span class="w">
</span><span class="nv">use</span><span class="w"> </span><span class="nv">scripting</span><span class="w"> </span><span class="nv">additions</span><span class="w">



</span><span class="c1">-- based on https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/ReadandWriteFiles.html</span><span class="w">
</span><span class="k">on</span> <span class="nv">writeTextToFile</span><span class="p">(</span><span class="nv">theText</span><span class="p">,</span><span class="w"> </span><span class="nv">theFile</span><span class="p">,</span><span class="w"> </span><span class="nv">overwriteExistingContent</span><span class="p">)</span><span class="w">
	</span><span class="k">try</span><span class="w">

		</span><span class="c1">-- Convert the file to a string</span><span class="w">
		</span><span class="k">set</span><span class="w"> </span><span class="nv">theFile</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nv">theFile</span><span class="w"> </span><span class="k">as </span><span class="nc">string</span><span class="w">

		</span><span class="c1">-- Open the file for writing</span><span class="w">
		</span><span class="k">set</span><span class="w"> </span><span class="nv">theOpenedFile</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">open for access</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">theFile</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nb">write</span><span class="w"> </span><span class="nv">permission</span><span class="w">

		</span><span class="c1">-- Clear the file if content should be overwritten</span><span class="w">
		</span><span class="k">if</span><span class="w"> </span><span class="nv">overwriteExistingContent</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nb">set eof</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nv">theOpenedFile</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">0</span><span class="w">

		</span><span class="c1">-- Write the new content to the file</span><span class="w">
		</span><span class="nb">write</span><span class="w"> </span><span class="nv">theText</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nv">theOpenedFile</span><span class="w"> </span><span class="nv">starting</span><span class="w"> </span><span class="nb">at</span><span class="w"> </span><span class="nv">eof</span><span class="w">

		</span><span class="c1">-- Close the file</span><span class="w">
		</span><span class="nb">close access</span><span class="w"> </span><span class="nv">theOpenedFile</span><span class="w">

		</span><span class="c1">-- Return a boolean indicating that writing was successful</span><span class="w">
		</span><span class="nb">return</span><span class="w"> </span><span class="nb">true</span><span class="w">

		</span><span class="c1">-- Handle a write error</span><span class="w">
	</span><span class="nb">on</span><span class="w"> </span><span class="k">error</span><span class="w">

		</span><span class="c1">-- Close the file</span><span class="w">
		</span><span class="k">try</span><span class="w">
			</span><span class="nb">close access</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">theFile</span><span class="w">
		</span><span class="k">end</span><span class="w"> </span><span class="k">try</span><span class="w">

		</span><span class="c1">-- Return a boolean indicating that writing failed</span><span class="w">
		</span><span class="nb">return</span><span class="w"> </span><span class="nb">false</span><span class="w">
	</span><span class="k">end</span><span class="w"> </span><span class="k">try</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="nv">writeTextToFile</span><span class="w">

</span><span class="c1">-- based on https://www.macscripter.net/t/image-png-to-text-through-applescript/74490/6</span><span class="w">
</span><span class="k">on</span> <span class="nv">getScreenText</span><span class="p">()</span><span class="w">
	</span><span class="nb">do shell script</span><span class="w"> </span><span class="s2">"screencapture -c "</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">thePasteboard</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">current application</span>'s <span class="nv">NSPasteboard</span>'s <span class="nv">generalPasteboard</span><span class="p">()</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">imageData</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nv">thePasteboard</span>'s <span class="nv">dataForType</span><span class="p">:(</span><span class="nb">current application</span>'s <span class="nv">NSPasteboardTypeTIFF</span><span class="p">)</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">requestHandler</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">current application</span>'s <span class="nv">VNImageRequestHandler</span>'s <span class="nv">alloc</span><span class="p">()</span>'s <span class="nv">initWithData</span><span class="p">:</span><span class="nv">imageData</span><span class="w"> </span><span class="nv">options</span><span class="p">:(</span><span class="nb">current application</span>'s <span class="nv">NSDictionary</span>'s <span class="nv">alloc</span><span class="p">()</span>'s <span class="nv">init</span><span class="p">())</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">theRequest</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">current application</span>'s <span class="nv">VNRecognizeTextRequest</span>'s <span class="nv">alloc</span><span class="p">()</span>'s <span class="nv">init</span><span class="p">()</span><span class="w">
	</span><span class="nv">requestHandler</span>'s <span class="nv">performRequests</span><span class="p">:(</span><span class="nb">current application</span>'s <span class="nv">NSArray</span>'s <span class="nv">arrayWithObject</span><span class="p">:(</span><span class="nv">theRequest</span><span class="p">))</span><span class="w"> </span><span class="err">|</span><span class="k">error</span><span class="err">|</span><span class="p">:(</span><span class="nb">missing value</span><span class="p">)</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">theResults</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nv">theRequest</span>'s <span class="nv">results</span><span class="p">()</span><span class="w">
	</span><span class="k">set</span><span class="w"> </span><span class="nv">theText</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">{}</span><span class="w">
	</span><span class="k">repeat</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">observation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">theResults</span><span class="w">
		</span><span class="nb">copy</span><span class="w"> </span><span class="p">((</span><span class="nb">first</span><span class="w"> </span><span class="nb">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="nv">observation</span>'s <span class="nv">topCandidates</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span>'s <span class="err">|</span><span class="nv">string</span><span class="err">|</span><span class="p">()</span><span class="w"> </span><span class="k">as </span><span class="nc">text</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nv">theText</span><span class="w">
	</span><span class="k">end</span><span class="w"> </span><span class="k">repeat</span><span class="w">
	</span><span class="nb">return</span><span class="w"> </span><span class="nv">theText</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="nv">getScreenText</span><span class="w">

</span><span class="k">on</span> <span class="nb">run</span><span class="w"> </span><span class="p">(</span><span class="nv">argv</span><span class="p">)</span><span class="w">
	</span><span class="nv">getScreenText</span><span class="p">()</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="nb">run</span><span class="w">
</span></code></pre></div></div> <h2 id="limitations"> <a href="#limitations" class="anchor-heading" aria-labelledby="limitations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Limitations </h2> <p>This version does not continue to run, nor write the captured text to a file or send it to a server so isn’t currently much use for much more than a proof of concept.</p> <p>This version doesn’t work in automator for reasons I don’t understand, so you can’t easily trigger it from a key press.</p> <p>It uses <code class="language-plaintext highlighter-rouge">screencapture</code> by shelling out, so this is quite easy to detect. I’m sure there are ways to do a screenshot more directly which would avoid this obvious detection. This can probably be avoided by using <a href="https://developer.apple.com/documentation/screencapturekit/scshareablecontent/3916733-getshareablecontentwithcompletio?language=objc">ScreenCaptureKit</a> but I couldn’t work out the syntax in AppleScript.</p> </main> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Richard Finlay Tweed. All rights reserved. All views expressed are my own</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
